---
import { getAssetById } from '../utils/content';

/**
 * ImageSection
 * 單張圖片展示區塊
 */
export interface Props {
  /** 圖片資源 ID（對應 asset-manifest） */
  image_id: string;
  /** 顯示裝置 @default 'all' */
  display?: 'all' | 'desktop' | 'mobile';
}

const { image_id, display = 'all' } = Astro.props;

// 從 asset-manifest 查詢圖片
const asset = await getAssetById(image_id);

// 根據 display 決定 CSS class (md = 768px)
const displayClass = display === 'desktop'
  ? 'hidden md:block'
  : display === 'mobile'
    ? 'block md:hidden'
    : 'block';
---

<!-- Vitesse Style: Simple image section -->
{asset ? (
  <section class:list={["py-6 md:py-8", displayClass]}>
    <div class="container-wide">
      <picture class="block w-full">
        <source media="(min-width: 768px)" srcset={asset.variants.desktop} />
        <source media="(max-width: 767px)" srcset={asset.variants.mobile} />
        <img
          src={asset.variants.desktop}
          alt={asset.alt}
          class="block w-full h-auto"
          loading="lazy"
          decoding="async"
        />
      </picture>
    </div>
  </section>
) : (
  <section class="py-10 md:py-12 bg-red-50 dark:bg-red-900/20">
    <div class="container-wide">
      <p class="text-red-600 dark:text-red-400 text-sm text-center p-5">圖片未找到: {image_id}</p>
    </div>
  </section>
)}
