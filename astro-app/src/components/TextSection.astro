---
export interface Props {
  id?: string;       // 錨點 ID
  content: string;
  title?: string;
  label?: string;
}

const { id, content, title, label } = Astro.props;

// 簡易 Markdown 轉 HTML
function parseMarkdown(md: string): string {
  let html = md
    // Headers
    .replace(/^#### (.+)$/gm, '<h4>$1</h4>')
    .replace(/^### (.+)$/gm, '<h3>$1</h3>')
    .replace(/^## (.+)$/gm, '<h2>$1</h2>')
    .replace(/^# (.+)$/gm, '<h1>$1</h1>')
    // Bold & Italic
    .replace(/\*\*(.+?)\*\*/g, '<strong>$1</strong>')
    .replace(/\*(.+?)\*/g, '<em>$1</em>')
    // Links
    .replace(/\[([^\]]+)\]\(([^)]+)\)/g, '<a href="$2">$1</a>')
    // Line breaks
    .replace(/\n\n/g, '</p><p>')
    .replace(/\n/g, '<br>');

  // Wrap in paragraph if not starting with a tag
  if (!html.startsWith('<')) {
    html = `<p>${html}</p>`;
  }

  return html;
}

const htmlContent = parseMarkdown(content);
---

<!-- Vitesse Style: Clean typography -->
<section class="py-12 md:py-16" id={id}>
  <div class="container-wide">
    {label && (
      <span class="inline-block text-xs font-medium text-[var(--accent)] uppercase tracking-wider mb-4">
        {label}
      </span>
    )}
    {title && (
      <h2 class="text-2xl md:text-3xl font-semibold text-[var(--text-primary)] mb-6">
        {title}
      </h2>
    )}
    <div
      class="prose max-w-none"
      set:html={htmlContent}
    />
  </div>
</section>
