---
export interface Props {
  id?: string;       // 錨點 ID
  content: string;
  title?: string;
  label?: string;
}

const { id, content, title, label } = Astro.props;

// 簡易 Markdown 轉 HTML
function parseMarkdown(md: string): string {
  let html = md
    // Headers
    .replace(/^#### (.+)$/gm, '<h4>$1</h4>')
    .replace(/^### (.+)$/gm, '<h3>$1</h3>')
    .replace(/^## (.+)$/gm, '<h2>$1</h2>')
    .replace(/^# (.+)$/gm, '<h1>$1</h1>')
    // Bold & Italic
    .replace(/\*\*(.+?)\*\*/g, '<strong>$1</strong>')
    .replace(/\*(.+?)\*/g, '<em>$1</em>')
    // Links
    .replace(/\[([^\]]+)\]\(([^)]+)\)/g, '<a href="$2">$1</a>')
    // Line breaks
    .replace(/\n\n/g, '</p><p>')
    .replace(/\n/g, '<br>');

  // Wrap in paragraph if not starting with a tag
  if (!html.startsWith('<')) {
    html = `<p>${html}</p>`;
  }

  return html;
}

const htmlContent = parseMarkdown(content);
---

<section class="py-[60px]" id={id}>
  <div class="max-w-[900px] mx-auto px-6 text-center">
    {label && (
      <span class="inline-block text-[13px] font-semibold text-brand uppercase tracking-[0.15em]
                   mb-4 px-5 py-2 border border-brand rounded-[20px]">
        {label}
      </span>
    )}
    {title && (
      <h2 class="text-[32px] md:text-[40px] font-bold text-brand mb-6 text-center">
        {title}
      </h2>
    )}
    <div
      class="prose text-base leading-relaxed text-secondary dark:text-gray-300 text-left
             [&_h1]:text-brand [&_h1]:mt-6 [&_h1]:mb-2 [&_h1]:font-semibold
             [&_h2]:text-brand [&_h2]:text-[28px] [&_h2]:mt-6 [&_h2]:mb-2 [&_h2]:font-semibold
             [&_h3]:text-brand [&_h3]:text-[22px] [&_h3]:mt-6 [&_h3]:mb-2 [&_h3]:font-semibold
             [&_h4]:text-brand [&_h4]:text-[18px] [&_h4]:mt-6 [&_h4]:mb-2 [&_h4]:font-semibold
             [&_p]:mb-4
             [&_a]:text-brand-hover [&_a]:underline [&_a:hover]:text-brand
             [&_ul]:my-4 [&_ul]:pl-6 [&_ol]:my-4 [&_ol]:pl-6
             [&_li]:mb-2
             [&_strong]:font-semibold [&_strong]:text-primary dark:[&_strong]:text-gray-100"
      set:html={htmlContent}
    />
  </div>
</section>
