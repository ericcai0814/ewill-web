---
import type { ResolvedImage } from '../utils/content';

export interface Props {
  image: ResolvedImage;
  overlay?: boolean;
  height?: 'full' | 'auto';
}

const { image, overlay = false, height = 'auto' } = Astro.props;
---

<section class:list={['hero', { 'hero--full': height === 'full', 'hero--overlay': overlay }]}>
  <picture class="hero__picture">
    <source media="(min-width: 1024px)" srcset={image.desktop} />
    <source media="(max-width: 1023px)" srcset={image.mobile} />
    <img
      src={image.desktop}
      alt={image.alt}
      class="hero__image"
      width="1920"
      height="600"
      loading="eager"
      decoding="async"
    />
  </picture>
  {overlay && <div class="hero__overlay"></div>}
  <slot />
</section>

<style>
  .hero {
    position: relative;
    width: 100%;
    overflow: hidden;
  }

  .hero--full {
    height: 100vh;
    min-height: 600px;
  }

  .hero__picture {
    display: block;
    width: 100%;
    height: 100%;
    /* 預留空間防止 CLS - Hero 橫幅比例約 16:5 */
    aspect-ratio: 16 / 5;
    background: #1A1A2E;
  }

  .hero__image {
    display: block;
    width: 100%;
    height: 100%;
    object-fit: cover;
  }

  .hero--full .hero__image {
    height: 100%;
    object-fit: cover;
  }

  .hero__overlay {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: linear-gradient(
      to bottom,
      rgba(0, 0, 0, 0.3) 0%,
      rgba(0, 0, 0, 0.1) 50%,
      rgba(0, 0, 0, 0.4) 100%
    );
    pointer-events: none;
  }

  .hero--overlay .hero__picture {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
  }
</style>
